<html>
<HEAD>
<TITLE>CS350 - Operating Systems</TITLE>
  <meta name="robots" content="noindex,nofollow">
  <META http-equiv="expires" content="0">
</HEAD>

<body>

<CENTER>
<H1>Assignment 1<BR>
Creating and Destroying a Process Hierarchy</H1>
</CENTER>
<center><i>Due Feb 15th midnight</i></center>

<H2>Objectives</H2>
<ul>
	<li>
		Learn how to create and terminate processes.
	</li>
	<li>
		Learn about process hierarchy.
	</li>
	<li>
		Learning to use system calls fork(), exec(), wait(), getpid(), getppid()
	</li>
	<li>
		Practice using command-line arguments and recursion.
	</li>
</ul>

<H2>Description</H2>
<P>
	You are being asked to write a program that will recursively create a process hierarchy tree that is H levels deep, print out the process tree information as the tree is being created, and then systematically terminate all the processes in the tree. Here are the detailed requirements:
	<ol>
		<li>
			Your program should accept two command-line arguments <B>H</B> and <B>C</B> that describe the structure of the process tree. The argument H is the height of the tree and C is the number of child processes belonging to each internal node of the process tree.
		</li>
		<li>
			Upon starting up, your program should first print the following information:
<pre>
		(pid): Process starting
		(pid): Parent's id = (ppid)
		(pid): Height in the tree = (value_of_H_from_command_line_argument)
		(pid): Creating (value_of_C_from_command_line) children at height (H-1)
</pre>
		In the above output, you should replace pid by the process id of the current process and ppid by the process id of the parent process.
		</li>
		<li>
			Next, if the height H is greater than 1, your program should create C child processes using <b>fork()</b>, and wait for all of the children to complete using the <b>wait()</b> system call. 
		</li>
		<li>
			Once all the child processes (if any) have terminated, your program should quit by printing.
<pre>
		(pid): Terminating at height (H).
</pre>
			Parent must not quit before ALL child processes terminate. <BR>
			Also, parent must call wait() ONLY AFTER CREATING ALL CHILDREN. (Think why?)
		</li>
		<li>
			What should each child process do while the parent waits? Recursion! Each of the child processes should use the <b>exec()</b> system call to run exactly the same program image as the parent. The only difference should be that the command-line argument received by the child proceses from the parent (via the exec() system call) should be <b>H-1</b> for height and <b>C</b> for number of children. <br>
			(<b>NOTE</b>: Recursion in this step can also be done without using exec(), via straightforward function calls. But you are REQUIRED to use exec() to start the child program image and pass arguments to it. Learning about exec() is one of the goals of this assignment.)
		</li>
		<li>
			Make the output more readable by neatly indenting the print statements above to match height of each process in the process heirarchy. (Do this at the end. Its worth only 5 points, but makes the TA's life easier while grading).
		</li>
	</ol>

<!--
For example, if the initial H=3 and C=2, then you get the following process hierarchy tree.

<pre>

		H=3          O
		H=2     0          0
		H=1  0     0    0     0
</pre>
-->

</P>


<H2>Grading Guidelines</H2>
<pre>
	This is how we will grade your assignment during the demo. So please prioritize your work accordingly.

	5 - README, Makefile, Compilation without errors

	5 - Creating and terminating a single process (H = 1, C = 1) and printing the correct output

	5 - Correct use of getpid() and getppid()

	40 - Correctly creating and terminating a hierarchy of processes with arbitrary H and C using fork(), exec(), and wait()

	10 - Demonstrating that recursion is implemented using exec() (and NOT using usual function calls)

	10 - Demonstrating that a parent process wait()s for child processes ONLY after it creates ALL child processes.

	10 - Demonstrating that a parent process wait()s for ALL child processes before terminating itself.

	20 - Explaining the code during demo.
		You will be asked to explain the logic of the code you wrote.

	10 - Error Handling
		Most important part here is to make sure that you check and handle the errors 
		returned by ALL systems calls used in your program. Also check for other common 
		error conditions in your program. But don't go overboard with error checking. 
		We will NOT try to intentionally break your code with bad input that's irrelevant 
		to the assignment's goal.

	5  - Indented formatting for output of processes at different heights in the hierarchy

	Total points = 120
</pre>

<H2>Hints</H2>
<P>
	<ol>
		<li>
			The entire program is likely very small, no more than a few tens of lines of code at most, if you think through it carefully.
		</li>
		<li>
			Use manpages to check the usage details of different system calls.
		</li>
		<li>
			Do this assignment as a regular user, NOT as root, to avoid corrupting your system accidentally.
		</li>
		<li>
			Use the command "kill -9 (pid)" to kill one process. Use "killall (program_name)" to kill all processes starting with a certain name. Use "kill -9 -1" to kill all processes owned by the current user (do this ONLY as a normal user, NEVER as root).
		</li>
		<li>
			Remember to terminate *all* the processes you create. If implemented incorrectly, you can easily end up writing a program that forks indefinitely. That's called a "fork bomb", and you don't want to handle cleaning up the mess. 
		</li>
		<li>
			If at all possible, try NOT to do this assignment on bingsuns machines. If you do something slightly wrong, you can end up with a fork bomb on the bingsuns server. The system administrators there won't like it and they will automatically disable your account. It will be a royal pain for you to get it reactivated. (This has happened before). Use a regular user account in your own virtual system image in the G-7 lab, so that you have root access to kill your processes, or to reboot the machine, if needed.
		</li>
	</ol>
</P>

<H2>Submission Guidelines</H2>
<ul>
	<li>
		Please submit all your code files as ONE tarred-gzipped file (.tgz file) through the Online Submission on the Blackboard. DO NOT SUBMIT EACH FILE INDIVIDUALY. Make one .tgz file. Check the <a href=http://www.cs.binghamton.edu/~kartik/cs350/contents.html#submissions>submission guidelines</a> on course web page for how to prepare a .tgz file.
	</li>
	<li>
		Remember to include a README file in your .tgz file above. The  README should have your name, list of files you are submitting, and any notes that the TA should know. For example, if you have anything interesting you want us to take note of, if there were any problems you ran into, or if you want to explain something in more detail. README file should be a simple text file that can be opened with any standard text editor.
	</li>
	<li>
		Remember to sign up for assignment demo with the TA. Signup sheet will be circulated in the class before the deadline. Please show up in the G-7 lab ahead of time, and be prepared with your program and code before the demo.
	</li>
</ul>

</body>

</html>
